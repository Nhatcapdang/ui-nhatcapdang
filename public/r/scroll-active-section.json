{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "scroll-active-section",
  "title": "Scroll Active Section",
  "description": "A powerful scroll-based component that displays content on the left side while showing an active item preview on the right. Perfect for showcasing features, timelines, or step-by-step processes.",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "src/components/scroll/scroll-active-section.tsx",
      "content": "'use client';\r\n\r\nimport { cn } from '@/utils/cn';\r\nimport { motion, useScroll, useTransform } from 'motion/react';\r\nimport { forwardRef, useEffect, useRef, useState } from 'react';\r\n\r\nexport interface ScrollItem {\r\n  id: string;\r\n  left: React.ReactNode;\r\n  right: React.ReactNode;\r\n}\r\n\r\nexport interface ScrollActiveSectionProps\r\n  extends React.HTMLAttributes<HTMLDivElement> {\r\n  items: ScrollItem[];\r\n  showProgress?: boolean;\r\n}\r\n\r\nconst ScrollActiveSection = forwardRef<\r\n  HTMLDivElement,\r\n  ScrollActiveSectionProps\r\n>(({ items, showProgress = true, className, ...props }, ref) => {\r\n  const desktopContainerRef = useRef<HTMLDivElement>(null);\r\n  const mobileContainerRef = useRef<HTMLDivElement>(null);\r\n\r\n  const [activeIndex, setActiveIndex] = useState(0);\r\n  const itemRefs = useRef<(HTMLDivElement | null)[]>([]);\r\n\r\n  const { scrollYProgress } = useScroll({\r\n    target: desktopContainerRef,\r\n    offset: ['center end', 'end end'],\r\n  });\r\n\r\n  const progressHeight = useTransform(scrollYProgress, [0, 1], ['15%', '100%']);\r\n\r\n  useEffect(() => {\r\n    // Mobile scroll handler\r\n    const handleMobileScroll = () => {\r\n      if (!mobileContainerRef.current) return;\r\n\r\n      const container = mobileContainerRef.current;\r\n      const scrollTop = container.scrollTop;\r\n      const containerHeight = container.clientHeight;\r\n      const itemHeight = 300; // Each item is 500px\r\n\r\n      // Calculate which item should be active based on scroll position\r\n      const activeIdx = Math.floor(\r\n        (scrollTop + containerHeight / 2) / itemHeight\r\n      );\r\n      const clampedIndex = Math.max(0, Math.min(activeIdx, items.length - 1));\r\n\r\n      setActiveIndex(clampedIndex);\r\n    };\r\n\r\n    // Desktop intersection observer\r\n    const desktopObserver = new IntersectionObserver(\r\n      entries => {\r\n        entries.forEach(entry => {\r\n          if (entry.isIntersecting) {\r\n            const index = itemRefs.current.indexOf(\r\n              entry.target as HTMLDivElement\r\n            );\r\n            if (index !== -1) {\r\n              setActiveIndex(index);\r\n            }\r\n          }\r\n        });\r\n      },\r\n      {\r\n        threshold: 0.6,\r\n        rootMargin: '-20% 0px -20% 0px',\r\n      }\r\n    );\r\n\r\n    // Capture current ref value for cleanup\r\n    const mobileContainer = mobileContainerRef.current;\r\n\r\n    // Setup mobile scroll listener\r\n    if (mobileContainer) {\r\n      mobileContainer.addEventListener('scroll', handleMobileScroll);\r\n      handleMobileScroll(); // Set initial state\r\n    }\r\n\r\n    // Setup desktop observer\r\n    itemRefs.current.forEach(ref => {\r\n      if (ref) desktopObserver.observe(ref);\r\n    });\r\n\r\n    return () => {\r\n      if (mobileContainer) {\r\n        mobileContainer.removeEventListener('scroll', handleMobileScroll);\r\n      }\r\n      desktopObserver.disconnect();\r\n    };\r\n  }, [items]);\r\n\r\n  const activeItem = items[activeIndex];\r\n\r\n  return (\r\n    <div ref={ref} className={cn('relative', className)} {...props}>\r\n      {/* Mobile Layout */}\r\n      <div className=\" md:hidden flex flex-col\">\r\n        <div className=\"overflow-hidden\">\r\n          <motion.div\r\n            data-slot=\"scroll-right-mobile\"\r\n            key={activeIndex}\r\n            initial={{ opacity: 0, y: 10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ duration: 0.3, ease: 'easeOut' }}\r\n            className=\"h-full p-1 flex items-center justify-center\"\r\n          >\r\n            {activeItem.right}\r\n          </motion.div>\r\n        </div>\r\n        <div className=\"overflow-y-auto h-[400px]\" ref={mobileContainerRef}>\r\n          <div data-slot=\"scroll-container-mobile\" className=\"relative\">\r\n            {items.map((item, index) => (\r\n              <div\r\n                data-slot=\"scroll-left-mobile\"\r\n                key={item.id}\r\n                ref={el => {\r\n                  if (el) {\r\n                    itemRefs.current[index] = el;\r\n                  }\r\n                }}\r\n                className={cn('min-h-[200px] py-4 flex items-center', {\r\n                  'opacity-100': index === activeIndex,\r\n                  'opacity-60': index !== activeIndex,\r\n                })}\r\n              >\r\n                {item.left}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Desktop Layout */}\r\n      <div className=\"hidden md:flex gap-8\">\r\n        <div\r\n          data-slot=\"scroll-container\"\r\n          ref={desktopContainerRef}\r\n          className=\"flex-1 relative\"\r\n        >\r\n          {showProgress && (\r\n            <div className=\"absolute left-0 top-0 w-px bg-border/30 h-full\">\r\n              <motion.div\r\n                data-slot=\"scroll-progress\"\r\n                className=\"w-full bg-primary origin-top\"\r\n                style={{ height: progressHeight }}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {items.map((item, index) => (\r\n            <div\r\n              data-slot=\"scroll-left\"\r\n              key={item.id}\r\n              ref={el => {\r\n                if (el) {\r\n                  itemRefs.current[index] = el;\r\n                }\r\n              }}\r\n              className={cn('min-h-[30vh] py-8', {\r\n                'opacity-100': index === activeIndex,\r\n                'opacity-60': index !== activeIndex,\r\n              })}\r\n            >\r\n              {item.left}\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <motion.div\r\n          data-slot=\"scroll-right\"\r\n          key={activeIndex}\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.5, ease: 'easeOut' }}\r\n          className=\"flex-1 sticky top-[25%] h-fit\"\r\n        >\r\n          {activeItem.right}\r\n        </motion.div>\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nScrollActiveSection.displayName = 'ScrollActiveSection';\r\n\r\nexport { ScrollActiveSection };\r\n",
      "type": "registry:component",
      "target": "src/nhatcapdang/scroll-active-section.tsx"
    }
  ],
  "type": "registry:component"
}